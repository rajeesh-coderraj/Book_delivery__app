!function(t,e,n,i){"use strict";function a(){var t=e.querySelector(".app-active");if(null!==t.querySelector("div.backdrop-panel")){var i=l[l.length-1].backdrop;i.classList.remove("fadeout"),t.removeChild(i)}l[l.length-1].panel.style.visibility="visible",s=!1,l.pop(),this.off(n.event.transitionEnd,a,!1)}function o(t){if(!s&&(t.style.visibility="visible",!t.classList.contains("active"))){t.classList.add("active");var n=n=c();e.querySelector(".app-active").appendChild(n),l.push({panel:t,backdrop:n})}}function r(t){if(!s&&t.classList.contains("active")&&!s){s=!0,t.classList.remove("active"),t.classList.add("panel-closing");var e=function(){t.classList.remove("panel-closing"),t.off(n.event.transitionEnd,e)};if(t.on(n.event.transitionEnd,e),l.length>0){var i=l[l.length-1].backdrop;i.classList.add("fadeout"),i.on(n.event.transitionEnd,a,!1)}}}var l=[],s=!1,c=function(){var t=e.createElement("div");return t.classList.add("backdrop-panel"),t},f=function(t){for(var n,i=e.querySelectorAll("[data-panel-id], [data-panel-close]");t&&t!==e;t=t.parentNode)for(n=i.length;n--;)if(i[n]===t)return t},d=function(t){var n=f(t.target);if(n){var i=n.getAttribute("data-panel-id");return i?e.querySelector("#"+i):p(t.target)}},p=function(t){for(var n,i=e.querySelectorAll(".panel, .panel-full");t&&t!==e;t=t.parentNode)for(n=i.length;n--;)if(i[n]===t&&t.classList.contains("active"))return t};e.on(n.event.start,function(t){if(t=t.originalEvent||t,!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification"))&&l.length>0){var e=l[l.length-1].panel,n=p(t.target);n||r(e),n&&n!==e&&n.id!==e.id&&r(e)}}),e.on(n.event.tap,function(t){if(!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification"))){var e=f(t.target),n=null;if(e&&(n=d(t),n&&(n.classList.contains("active")?r(n):o(n))),n=p(t.target),!n&&!e&&l.length>0){var i=l[l.length-1].panel;p(t.target);r(i)}}}),n.panel=function(t){if("undefined"==typeof t)return{closeActive:function(){var t=l.length>0?!0:!1;return t&&r(l[l.length-1].panel),t}};var n="string"==typeof t?e.querySelector(t):t;if(null===n)throw new Error("The panel with ID "+t+" does not exist");return{open:function(){o(n)},close:function(){r(n)}}},t.phonon=n,"object"==typeof exports?module.exports=n.panel:"function"==typeof define&&define.amd&&define(function(){return n.panel})}(window,document,window.phonon||{});